---
- name: Increase counter.
  set_fact:
    counter: "{{ counter | default(-1) | int + 1 }}"

- debug:
    msg: "{{ counter | int }}"

- include_tasks: mem-troubleshooting.yaml

- name: set task result as 1 (failure)
  set_fact:
    task_result: 1
  when: not find_solution | bool

- debug: 
    msg: "{{ hostvars['localhost']['ansible_facts'] }}"

- name: Test task list
  set_fact: 
    rule_base_task_list: "{{ hostvars['localhost']['ansible_facts']['rule_base_task_list'] }}"

- include_tasks: mem-execute-recommendation.yaml
  when: find_solution | bool

- include_tasks: loop_mem-execute-recommendation.yaml
  when: 
  - counter | int < loop_counter | int
  - success is not defined
  - find_solution | bool
